# ğŸ›’ ë‹¹ë§ˆ(DangMa) - ì¤‘ê³ ê±°ë˜ í”Œë«í¼

![Python](https://img.shields.io/badge/Python-3.12-blue)
![Django](https://img.shields.io/badge/Django-5.1.6-green)
![Docker](https://img.shields.io/badge/Docker-Compose-blue)
![Nginx](https://img.shields.io/badge/Nginx-1.21-brightgreen)
![CI/CD](https://img.shields.io/badge/CI/CD-GitHub_Actions-blue)

## ğŸ“‹ í”„ë¡œì íŠ¸ ì†Œê°œ

**ë‹¹ë§ˆ**ëŠ” ìœ„ì¹˜ ê¸°ë°˜ ì¤‘ê³  ê±°ë˜ í”Œë«í¼ìœ¼ë¡œ, Django í”„ë ˆì„ì›Œí¬ë¥¼ í™œìš©í•œ ë°±ì—”ë“œ API ì„œë²„ì…ë‹ˆë‹¤. ì‚¬ìš©ìê°€ ê·¼ì²˜ ì´ì›ƒë“¤ê³¼ ì¤‘ê³  ë¬¼í’ˆì„ ì‰½ê²Œ ê±°ë˜í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ì‹œìŠ¤í…œì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

### ì£¼ìš” íŠ¹ì§•
- **ìœ„ì¹˜ ê¸°ë°˜ ì„œë¹„ìŠ¤**: ì‚¬ìš©ì ìœ„ì¹˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì£¼ë³€ ìƒí’ˆ ê²€ìƒ‰ ë° í™œë™ ì§€ì—­ ì„¤ì •
- **ì‹¤ì‹œê°„ ì±„íŒ…**: WebSocketì„ í™œìš©í•œ ì‹¤ì‹œê°„ ì±„íŒ… ê¸°ëŠ¥ìœ¼ë¡œ íŒë§¤ì-êµ¬ë§¤ì ê°„ ì†Œí†µ
- **ì‚¬ìš©ì í‰ê°€ ì‹œìŠ¤í…œ**: ë§¤ë„ˆì˜¨ë„ì™€ ë¦¬ë·°ë¥¼ í†µí•œ ì‹ ë¢°ë„ í‰ê°€
- **API ê¸°ë°˜ ì„¤ê³„**: RESTful API íŒ¨í„´ì„ í†µí•œ í™•ì¥ ê°€ëŠ¥í•œ ì„œë¹„ìŠ¤ êµ¬ì¡°
- **ì»¨í…Œì´ë„ˆ ê¸°ë°˜ ë°°í¬**: Dockerì™€ GitHub Actionsë¥¼ í™œìš©í•œ CI/CD íŒŒì´í”„ë¼ì¸

## ğŸ”§ ê¸°ìˆ  ìŠ¤íƒ

### ë°±ì—”ë“œ
- **ì–¸ì–´ & í”„ë ˆì„ì›Œí¬**: Python 3.12, Django 5.1.6
- **API**: REST Framework
- **ë°ì´í„°ë² ì´ìŠ¤**: PostgreSQL + PostGIS(ìœ„ì¹˜ ë°ì´í„°)
- **ë¹„ë™ê¸° ì²˜ë¦¬**: Channels, Daphne (WebSocket)
- **ì¸ì¦**: JWT í† í° ê¸°ë°˜ ì¸ì¦

### ì¸í”„ë¼
- **ì»¨í…Œì´ë„ˆí™”**: Docker, Docker Compose
- **ì›¹ ì„œë²„**: Nginx
- **CI/CD**: GitHub Actions
- **SSL/TLS**: Let's Encrypt
- **ë°°í¬ í™˜ê²½**: AWS

## ğŸ’» ì£¼ìš” ê¸°ëŠ¥

### 1. ì¸ì¦ ë° ì‚¬ìš©ì ê´€ë¦¬
- JWT ê¸°ë°˜ ì‚¬ìš©ì ì¸ì¦
- ì´ë©”ì¼ ì¸ì¦ ì‹œìŠ¤í…œ
- ì‚¬ìš©ì í”„ë¡œí•„ ê´€ë¦¬

### 2. ìƒí’ˆ ê´€ë¦¬
- ìƒí’ˆ ë“±ë¡, ìˆ˜ì •, ì‚­ì œ, ì¡°íšŒ
- ì¹´í…Œê³ ë¦¬ë³„ ìƒí’ˆ ë¶„ë¥˜
- ê°€ê²© ì œì•ˆ ì‹œìŠ¤í…œ

### 3. ìœ„ì¹˜ ê¸°ë°˜ ì„œë¹„ìŠ¤
- ì§€ì—­ ì¸ì¦ ë° í™œë™ ì§€ì—­ ì„¤ì •
- ë°˜ê²½ ê¸°ë°˜ ê·¼ì²˜ ìƒí’ˆ ê²€ìƒ‰
- ê³µê°„ ë°ì´í„° í™œìš© (SGIS API ì—°ë™)

### 4. ì‹¤ì‹œê°„ ì±„íŒ…
- WebSocketì„ í™œìš©í•œ ì‹¤ì‹œê°„ ë©”ì‹œì§€
- 1:1 ì±„íŒ…ë°© ê´€ë¦¬
- íŒŒì¼/ì´ë¯¸ì§€ ì „ì†¡ ì§€ì›

### 5. ê±°ë˜ ê´€ë¦¬
- ê±°ë˜ ì•½ì† ì„¤ì •
- ê±°ë˜ í›„ê¸° ë° í‰ê°€
- ë§¤ë„ˆ ì˜¨ë„ ì‹œìŠ¤í…œ

## ğŸ—‚ï¸ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
ë‹¹ë§ˆ(DangMa)/
â”œâ”€â”€ django/                 # Django ì• í”Œë¦¬ì¼€ì´ì…˜
â”‚   â”œâ”€â”€ a_core/             # í”„ë¡œì íŠ¸ ì„¤ì • ë° ì½”ì–´
â”‚   â”œâ”€â”€ a_apis/             # API ì—”ë“œí¬ì¸íŠ¸ ë° ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”œâ”€â”€ a_user/             # ì‚¬ìš©ì ê´€ë ¨ ê¸°ëŠ¥
â”‚   â””â”€â”€ a_common/           # ê³µí†µ ëª¨ë“ˆ ë° ìœ í‹¸ë¦¬í‹°
â”œâ”€â”€ nginx/                  # Nginx ì„¤ì •
â””â”€â”€ scripts/                # ìœ í‹¸ë¦¬í‹° ìŠ¤í¬ë¦½íŠ¸
```

## ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

ë‹¹ë§ˆ í”„ë¡œì íŠ¸ëŠ” ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì§€í–¥ì  ì•„í‚¤í…ì²˜ë¡œ ì„¤ê³„ë˜ì–´ ìˆìœ¼ë©°, Docker ì»¨í…Œì´ë„ˆ ê¸°ë°˜ìœ¼ë¡œ ë°°í¬ë©ë‹ˆë‹¤.

```mermaid
flowchart TD
    %% ì£¼ìš” êµ¬ì„±ìš”ì†Œ ì •ì˜
    Client([í´ë¼ì´ì–¸íŠ¸ ì•±])
    Nginx{Nginx}
    ASGI[Django ASGI]
    WSGI[Django WSGI]
    Django{{Django ì• í”Œë¦¬ì¼€ì´ì…˜}}
    DB[(PostgreSQL + PostGIS)]
    Redis[(Redis)]
    External([ì™¸ë¶€ API])
    
    %% ì£¼ìš” ëª¨ë“ˆ ì •ì˜ \
    Core([a_core])
    Apis([a_apis])
    User([a_user])
    Common([a_common])
    
    %% ì—°ê²° ê´€ê³„
    Client -->|HTTPS/WSS| Nginx
    Nginx -->|WS| ASGI
    Nginx -->|HTTP| WSGI
    ASGI --> Django
    WSGI --> Django
    
    Django --> Core & Apis & User & Common
    Django <-->|READ/WRITE| DB
    Django <-->|ìºì‹±/ë©”ì‹œì§•| Redis
    Django <-->|API ì—°ë™| External
    
    %% ìŠ¤íƒ€ì¼ë§ - ë” ë†’ì€ ëŒ€ë¹„ì˜ ìƒ‰ìƒìœ¼ë¡œ ì¡°ì •
    classDef client fill:#e6f7ff,stroke:#0066cc,stroke-width:2px,color:#000000
    classDef server fill:#ccefdc,stroke:#006633,stroke-width:2px,color:#000000
    classDef app fill:#fff2cc,stroke:#996600,stroke-width:2px,color:#000000
    classDef module fill:#e6e6ff,stroke:#000066,stroke-width:2px,color:#000000
    classDef database fill:#f9d9ff,stroke:#660066,stroke-width:2px,color:#000000
    classDef external fill:#ffe6e6,stroke:#990000,stroke-width:2px,color:#000000
    
    class Client client
    class Nginx,ASGI,WSGI server
    class Django app
    class Core,Apis,User,Common module
    class DB,Redis database
    class External external
```

### ì£¼ìš” ì»´í¬ë„ŒíŠ¸ ì„¤ëª…

1. **í”„ë¡ íŠ¸ì—”ë“œ**: ì›¹/ëª¨ë°”ì¼ í´ë¼ì´ì–¸íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜
2. **ì¸í”„ë¼ ê³„ì¸µ**:
   - **Nginx**: ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ ë° ë¡œë“œ ë°¸ëŸ°ì„œ ì—­í• , ì •ì  íŒŒì¼ ì œê³µ
   - **Docker**: ì»¨í…Œì´ë„ˆí™”ëœ ì„œë¹„ìŠ¤ ê´€ë¦¬
3. **ë°±ì—”ë“œ ì„œë²„ ê³„ì¸µ**:
   - **Django ASGI (Daphne)**: WebSocket ì²˜ë¦¬, ì‹¤ì‹œê°„ ì±„íŒ… ê¸°ëŠ¥
   - **Django WSGI (Gunicorn)**: HTTP API ìš”ì²­ ì²˜ë¦¬
4. **ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ**:
   - **a_core**: í”„ë¡œì íŠ¸ í•µì‹¬ ì„¤ì • ë° URL ë¼ìš°íŒ…
   - **a_apis**: API ì—”ë“œí¬ì¸íŠ¸, ëª¨ë¸, ì„œë¹„ìŠ¤ ë¡œì§
   - **a_user**: ì‚¬ìš©ì ê´€ë¦¬ ë° ì¸ì¦
   - **a_common**: ê³µí†µ ìœ í‹¸ë¦¬í‹°
5. **ë°ì´í„° ê³„ì¸µ**:
   - **PostgreSQL + PostGIS**: ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ + ì§€ë¦¬ ê³µê°„ ë°ì´í„°
   - **Redis**: ìºì‹±, ì„¸ì…˜ ê´€ë¦¬, ì‹¤ì‹œê°„ ì±„íŒ… ì±„ë„ ë ˆì´ì–´

### ì£¼ìš” ê¸°ìˆ  íë¦„ë„

```mermaid
sequenceDiagram
    actor User as ì‚¬ìš©ì
    participant Client as í´ë¼ì´ì–¸íŠ¸
    participant Nginx as Nginx
    participant API as Django API
    participant DB as PostgreSQL
    
    User->>Client: ìœ„ì¹˜ ê¸°ë°˜ ìƒí’ˆ ê²€ìƒ‰
    Client->>Nginx: API ìš”ì²­
    Nginx->>API: HTTP ë¼ìš°íŒ…
    API->>DB: PostGIS ê³µê°„ ì¿¼ë¦¬
    DB-->>API: ìœ„ì¹˜ ê¸°ë°˜ ê²°ê³¼
    API-->>Nginx: JSON ì‘ë‹µ
    Nginx-->>Client: ì‘ë‹µ
    Client-->>User: ê²°ê³¼ í‘œì‹œ
```

### ë³´ì•ˆ ì•„í‚¤í…ì²˜

JWT ê¸°ë°˜ ì¸ì¦ ì‹œìŠ¤í…œê³¼ ì¿ í‚¤ ì¸ì¦ì„ ì§€ì›í•˜ë©°, ëª¨ë“  í†µì‹ ì€ HTTPSë¥¼ í†µí•´ ì•”í˜¸í™”ë©ë‹ˆë‹¤. ê¶Œí•œ ê¸°ë°˜ ì ‘ê·¼ ì œì–´ë¥¼ í†µí•´ ì•ˆì „í•œ API ì‚¬ìš©ì„ ë³´ì¥í•©ë‹ˆë‹¤.

## ğŸ” ì£¼ìš” API ì—”ë“œí¬ì¸íŠ¸

### ì¸ì¦ API
- `POST /api/auth/signup/`: íšŒì›ê°€ì…
- `POST /api/auth/login/`: ë¡œê·¸ì¸
- `POST /api/auth/refresh/`: í† í° ê°±ì‹ 

### ì‚¬ìš©ì API
- `GET /api/users/me/`: ë‚´ ì •ë³´ ì¡°íšŒ
- `PATCH /api/users/me/`: ë‚´ ì •ë³´ ìˆ˜ì •
- `GET /api/users/regions/`: ë‚´ í™œë™ ì§€ì—­ ì¡°íšŒ

### ìƒí’ˆ API
- `GET /api/products/`: ìƒí’ˆ ëª©ë¡ ì¡°íšŒ
- `POST /api/products/`: ìƒí’ˆ ë“±ë¡
- `GET /api/products/{id}/`: ìƒí’ˆ ìƒì„¸ ì¡°íšŒ
- `POST /api/products/{id}/interests/`: ê´€ì‹¬ ìƒí’ˆ ë“±ë¡/í•´ì œ

### ì±„íŒ… API
- `GET /api/chats/rooms/`: ë‚´ ì±„íŒ…ë°© ëª©ë¡
- `POST /api/chats/rooms/`: ì±„íŒ…ë°© ìƒì„±
- WebSocket ì—°ê²°: `ws://domain/ws/chat/{room_id}/`

## ğŸ“Š ERD ì„¤ê³„
![ERD ì„¤ê³„](https://github.com/user-attachments/assets/c89dcbe9-a762-473d-906d-c172460d599c)

## ğŸš€ ë¡œì»¬ ê°œë°œ í™˜ê²½ ì„¤ì •

### ì‚¬ì „ ìš”êµ¬ì‚¬í•­
- Python 3.12 ì´ìƒ
- Poetry
- Docker & Docker Compose

### ì„¤ì¹˜ ë° ì‹¤í–‰

1. ë ˆí¬ì§€í† ë¦¬ í´ë¡ 
```bash
git clone https://github.com/yourusername/dangma.git
cd dangma
```

2. Poetryë¡œ ì˜ì¡´ì„± ì„¤ì¹˜
```bash
poetry install
poetry shell
```

3. Django ì„¤ì •
```bash
cd django
poetry run python manage.py makemigrations --settings=a_core.settings.development
poetry run python manage.py migrate --settings=a_core.settings.development
```

4. ê°œë°œ ì„œë²„ ì‹¤í–‰
```bash
poetry run python manage.py runserver --settings=a_core.settings.development
```

5. API ë¬¸ì„œ ì ‘ì†
```
https://api.dangma.store/api/docs#/
```

### Dockerë¥¼ í†µí•œ ì‹¤í–‰
```bash
docker-compose up -d
```

## ğŸ”„ CI/CD ì›Œí¬í”Œë¡œìš°

GitHub Actionsë¥¼ í†µí•œ CI/CD íŒŒì´í”„ë¼ì¸:
- develop â†’ main ë¸Œëœì¹˜ ë³‘í•© ì‹œ ìë™ ë°°í¬
- í…ŒìŠ¤íŠ¸ ìë™í™” ë° í’ˆì§ˆ ê²€ì‚¬
- Docker ì´ë¯¸ì§€ ë¹Œë“œ ë° ë°°í¬
- ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜ ìë™í™”

## ğŸ“ ì„±ê³¼ ë° ë°°ìš´ ì 

- **í™•ì¥ ê°€ëŠ¥í•œ ì•„í‚¤í…ì²˜ ì„¤ê³„**: ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì§€í–¥ì ì¸ êµ¬ì¡°ë¡œ ëª¨ë“ˆ ê°„ ì˜ì¡´ì„± ìµœì†Œí™”
- **ì‹¤ì‹œê°„ ê¸°ëŠ¥ êµ¬í˜„**: WebSocketì„ í™œìš©í•œ ì‹¤ì‹œê°„ ì±„íŒ… ì‹œìŠ¤í…œ êµ¬ì¶•
- **ê³µê°„ ë°ì´í„° ì²˜ë¦¬**: PostGISë¥¼ í™œìš©í•œ ìœ„ì¹˜ ê¸°ë°˜ ê²€ìƒ‰ ë° í•„í„°ë§ êµ¬í˜„
- **CI/CD ìë™í™”**: GitHub Actionsì„ í™œìš©í•œ ë°°í¬ íŒŒì´í”„ë¼ì¸ êµ¬ì¶•
- **ë³´ì•ˆ ê°•í™”**: JWT í† í° ê¸°ë°˜ ì¸ì¦ ë° HTTPS ì ìš©

## ğŸ“ˆ í–¥í›„ ê°œì„  ê³„íš

- ì•Œë¦¼ ì‹œìŠ¤í…œ êµ¬ì¶• (FCM, WebPush)
- ê²€ìƒ‰ ê¸°ëŠ¥ ìµœì í™” (Elasticsearch ë„ì…)
- ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¡œì˜ ì ì§„ì  ì „í™˜
- ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ë„ì… (Prometheus, Grafana)

## ğŸ‘¨â€ğŸ’» ì—°ë½ì²˜

- **ê°œë°œì**: ì´ì¬í›ˆ
- **ì´ë©”ì¼**: ljhx6787@baver.com
- **GitHub**: https://github.com/Jeedoli
---

Â© 2025 ë‹¹ë§ˆ(DangMa) í”„ë¡œì íŠ¸
